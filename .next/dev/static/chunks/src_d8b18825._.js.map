{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Jelly/src/lib/highcharts.ts"],"sourcesContent":["// @ts-nocheck — Highcharts ES module masters lack type declarations\n// Import both from es-modules path so they share the same Globals instance\nimport Highcharts from \"highcharts/es-modules/masters/highstock.src.js\";\nimport \"highcharts/es-modules/masters/highcharts-more.src.js\";\n\nHighcharts.setOptions({\n  chart: {\n    backgroundColor: \"transparent\",\n  },\n  title: { text: undefined },\n  credits: { enabled: false },\n  legend: { enabled: false },\n  xAxis: {\n    gridLineColor: \"rgba(255,255,255,0.06)\",\n    lineColor: \"rgba(255,255,255,0.12)\",\n    labels: { style: { color: \"#9ca3af\" } },\n  },\n  yAxis: {\n    gridLineColor: \"rgba(255,255,255,0.06)\",\n    labels: { style: { color: \"#9ca3af\" } },\n    title: { text: undefined },\n  },\n  tooltip: {\n    backgroundColor: \"rgba(17,24,39,0.92)\",\n    borderColor: \"rgba(255,255,255,0.12)\",\n    style: { color: \"#e5e7eb\" },\n  },\n  navigator: {\n    outlineColor: \"rgba(255,255,255,0.18)\",\n    maskFill: \"rgba(255,255,255,0.05)\",\n    series: { color: \"#6366f1\" },\n    xAxis: { labels: { style: { color: \"#9ca3af\" } } },\n  },\n  rangeSelector: {\n    buttonTheme: {\n      fill: \"rgba(255,255,255,0.06)\",\n      stroke: \"rgba(255,255,255,0.12)\",\n      style: { color: \"#9ca3af\" },\n      states: {\n        hover: { fill: \"rgba(255,255,255,0.12)\" },\n        select: { fill: \"rgba(99,102,241,0.3)\", style: { color: \"#e5e7eb\" } },\n      },\n    },\n    inputStyle: { color: \"#e5e7eb\", backgroundColor: \"rgba(255,255,255,0.06)\" },\n    labelStyle: { color: \"#9ca3af\" },\n  },\n  scrollbar: {\n    barBackgroundColor: \"rgba(255,255,255,0.12)\",\n    trackBackgroundColor: \"rgba(255,255,255,0.04)\",\n    buttonBackgroundColor: \"rgba(255,255,255,0.06)\",\n  },\n});\n\nexport default Highcharts;\n"],"names":[],"mappings":";;;;AAAA,oEAAoE;AACpE,2EAA2E;AAC3E;AACA;;;AAEA,wLAAU,CAAC,UAAU,CAAC;IACpB,OAAO;QACL,iBAAiB;IACnB;IACA,OAAO;QAAE,MAAM;IAAU;IACzB,SAAS;QAAE,SAAS;IAAM;IAC1B,QAAQ;QAAE,SAAS;IAAM;IACzB,OAAO;QACL,eAAe;QACf,WAAW;QACX,QAAQ;YAAE,OAAO;gBAAE,OAAO;YAAU;QAAE;IACxC;IACA,OAAO;QACL,eAAe;QACf,QAAQ;YAAE,OAAO;gBAAE,OAAO;YAAU;QAAE;QACtC,OAAO;YAAE,MAAM;QAAU;IAC3B;IACA,SAAS;QACP,iBAAiB;QACjB,aAAa;QACb,OAAO;YAAE,OAAO;QAAU;IAC5B;IACA,WAAW;QACT,cAAc;QACd,UAAU;QACV,QAAQ;YAAE,OAAO;QAAU;QAC3B,OAAO;YAAE,QAAQ;gBAAE,OAAO;oBAAE,OAAO;gBAAU;YAAE;QAAE;IACnD;IACA,eAAe;QACb,aAAa;YACX,MAAM;YACN,QAAQ;YACR,OAAO;gBAAE,OAAO;YAAU;YAC1B,QAAQ;gBACN,OAAO;oBAAE,MAAM;gBAAyB;gBACxC,QAAQ;oBAAE,MAAM;oBAAwB,OAAO;wBAAE,OAAO;oBAAU;gBAAE;YACtE;QACF;QACA,YAAY;YAAE,OAAO;YAAW,iBAAiB;QAAyB;QAC1E,YAAY;YAAE,OAAO;QAAU;IACjC;IACA,WAAW;QACT,oBAAoB;QACpB,sBAAsB;QACtB,uBAAuB;IACzB;AACF;uCAEe,wLAAU"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Jelly/src/components/CompareCharts.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useMemo, useState } from \"react\";\nimport HighchartsReact from \"highcharts-react-official\";\nimport Highcharts from \"@/lib/highcharts\";\nimport type { PricePoint, EventItem } from \"@/lib/data\";\nimport {\n  DAY,\n  sliceByRange,\n  pct,\n  fmtPct,\n  volApprox,\n  EVENT_TYPES,\n} from \"@/lib/data\";\nimport { Toolbar, Chip, Button } from \"./Toolbar\";\n\ninterface Props {\n  selectedEvent: EventItem | null;\n  price: PricePoint[];\n  onReset: () => void;\n  priceRange?: { min: number; max: number };\n}\n\nfunction makeCompareOptions(\n  data: PricePoint[],\n  eventFlag: { x: number; title: string; text: string } | null,\n  priceRange?: { min: number; max: number },\n): Highcharts.Options {\n  return {\n    credits: { enabled: true },\n    legend: { enabled: true },\n    tooltip: { shared: true },\n    xAxis: { type: \"datetime\" as const },\n    yAxis: {\n      tickPixelInterval: 30,\n      ...(priceRange && {\n        min: priceRange.min,\n        max: priceRange.max,\n      }),\n    },\n    series: [\n      {\n        id: \"cmpPrice\",\n        type: \"line\" as const,\n        name: \"Price\",\n        marker: { enabled: false },\n        data,\n      },\n      {\n        id: \"cmpEvent\",\n        type: \"flags\" as const,\n        onSeries: \"cmpPrice\",\n        shape: \"circlepin\",\n        data: eventFlag ? [eventFlag] : [],\n      },\n    ],\n  };\n}\n\nexport default function CompareCharts({\n  selectedEvent,\n  price,\n  onReset,\n  priceRange,\n}: Props) {\n  const [rangeDays, setRangeDays] = useState(30);\n\n  const { beforeData, afterData, flag } = useMemo(() => {\n    if (!selectedEvent) return { beforeData: [], afterData: [], flag: null };\n    const x = selectedEvent.x;\n    return {\n      beforeData: sliceByRange(price, x - rangeDays * DAY, x),\n      afterData: sliceByRange(price, x, x + rangeDays * DAY),\n      flag: { x, title: selectedEvent.title, text: selectedEvent.desc },\n    };\n  }, [selectedEvent, price, rangeDays]);\n\n  const beforeOpts = useMemo(\n    () => makeCompareOptions(beforeData, flag, priceRange),\n    [beforeData, flag, priceRange]\n  );\n  const afterOpts = useMemo(\n    () => makeCompareOptions(afterData, flag, priceRange),\n    [afterData, flag, priceRange]\n  );\n\n  const kpis = useMemo(() => {\n    if (!selectedEvent)\n      return { event: \"-\", before: \"-\", after: \"-\", vol: \"-\" };\n\n    const b0 = beforeData[0]?.[1];\n    const b1 = beforeData[beforeData.length - 1]?.[1];\n    const a0 = afterData[0]?.[1];\n    const a1 = afterData[afterData.length - 1]?.[1];\n    const v = volApprox(afterData);\n\n    return {\n      event: `${EVENT_TYPES[selectedEvent.type].name} / ${selectedEvent.text}`,\n      before: fmtPct(pct(b0, b1)),\n      after: fmtPct(pct(a0, a1)),\n      vol: v == null ? \"-\" : v.toFixed(2) + \"%\",\n    };\n  }, [selectedEvent, beforeData, afterData]);\n\n  const leftTitle = selectedEvent\n    ? `Before: D-${rangeDays} ~ D (${selectedEvent.text})`\n    : \"Before (선택 전)\";\n  const rightTitle = selectedEvent\n    ? `After: D ~ D+${rangeDays} (${selectedEvent.text})`\n    : \"After (선택 전)\";\n\n  return (\n    <div className=\"card mt-3\">\n      <h2 className=\"text-sm font-semibold text-gray-200 my-1 mb-2.5\">\n        Before / After 비교\n      </h2>\n      <Toolbar>\n        <Chip>클릭한 이벤트 기준</Chip>\n        <Chip>D-{rangeDays}~D</Chip>\n        <Chip>D~D+{rangeDays}</Chip>\n        {[30, 60].map((d) => (\n          <button key={d} onClick={() => setRangeDays(d)}\n            className={`text-[11px] px-2 py-0.5 rounded-full border ${\n              rangeDays === d\n                ? \"border-blue-500 text-blue-400 bg-blue-500/10\"\n                : \"border-gray-700 text-gray-500 hover:text-gray-300\"\n            }`}>\n            {d}일\n          </button>\n        ))}\n        <Button onClick={onReset}>선택 해제</Button>\n      </Toolbar>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n        <div>\n          <Chip>{leftTitle}</Chip>\n          <div className=\"h-[360px] mt-2\">\n            <HighchartsReact\n              key={`before-${selectedEvent?.id}`}\n              highcharts={Highcharts}\n              constructorType=\"chart\"\n              options={beforeOpts}\n              containerProps={{ style: { height: \"100%\" } }}\n            />\n          </div>\n        </div>\n        <div>\n          <Chip>{rightTitle}</Chip>\n          <div className=\"h-[360px] mt-2\">\n            <HighchartsReact\n              key={`after-${selectedEvent?.id}`}\n              highcharts={Highcharts}\n              constructorType=\"chart\"\n              options={afterOpts}\n              containerProps={{ style: { height: \"100%\" } }}\n            />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2.5\">\n        <KpiBox label=\"선택 이벤트\" value={kpis.event} />\n        <KpiBox label=\"Before 수익률\" value={kpis.before} />\n        <KpiBox label=\"After 수익률\" value={kpis.after} />\n        <KpiBox label=\"After 변동성(대략)\" value={kpis.vol} />\n      </div>\n\n      <p className=\"text-gray-500 text-xs mt-2 leading-relaxed\">\n        이벤트 클릭 → 전후 구간을 자동으로 잘라 비교합니다.\n      </p>\n    </div>\n  );\n}\n\nfunction KpiBox({ label, value }: { label: string; value: string }) {\n  return (\n    <div className=\"border border-gray-800 rounded-xl p-2 bg-black/15\">\n      <div className=\"text-[11px] text-gray-500\">{label}</div>\n      <div className=\"text-[13px] font-bold mt-0.5\">{value}</div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}